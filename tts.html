<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Audio</title>
  </head>
  <body>
    <form>
      <textarea rows="10" cols="80">Enter Text To Speak Here.</textarea>
      <br/>
      <button type="submit">Speak</button>
      <button type="button" id="pause">Pause</button>
      <button type="button" id="resume">Resume</button>
      <button type="button" id="cancel">Cancel</button>
    </form>
    <p></p>
    <div></div>
  </body>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.3/jquery.min.js"></script>
  <script type="text/javascript">
  $(document).ready(function(){
    var index = 0;
    var sentences;
    var indexEnd = 0;
    if ('speechSynthesis' in window) {}
    else { alert("Speech Synthesis not supported"); }

    /*if ('SpeechRecognition' in window) {
    } else {
      alert("Speech Recogniciton not supported");
    }*/
    var msg = new SpeechSynthesisUtterance();
    var voices = window.speechSynthesis.getVoices();
    console.log(voices);
    //msg.voice = voices[10]; // Note: some voices don't support altering params
    //msg.voiceURI = 'native';
    //msg.volume = 1; // 0 to 1
    //msg.rate = 1; // 0.1 to 10
    //msg.pitch = 2; //0 to 2
    msg.text = 'Hello Carlton';
    msg.lang = 'en-US';

    msg.onend = function(e) {
      console.log('Finished in ' + e.elapsedTime + ' seconds.');
      if (index < indexEnd) {
        showSentence();
        speechSynthesis.speak(msg);
      } else {
        $("div").text("");
        $("p").text("");
        speechSynthesis.cancel();
      }
    };

    $("input").text(msg.text);
    $("#pause").click(function (e) { speechSynthesis.pause(); });
    $("#resume").click(function (e) { speechSynthesis.resume(); });
    $("#cancel").click(function (e) {
      speechSynthesis.cancel();
      $("div").text("");
      $("p").text("");
      index = indexEnd;
    });
    $("form").submit(function (event) {
        index = 0;
        sentences = $("textarea").val().split(/[.?\n]+/);
        indexEnd = sentences.length;
        console.log("Sentences found = " + indexEnd);
        showSentence()
        $("p").text("");
        sentences.forEach(function (entry) {
          $("p").append(entry + "<br/>");
        });
        speechSynthesis.speak(msg);
        event.preventDefault();
    })
    // speechSynthesis.speak(msg);
    function showSentence() {
      msg.text = sentences[index++];
      $("div").text(index + "/" + indexEnd + " " + msg.text);
    }
  });

  </script>
</html>
